<div class="container" ng-init="init()">
  <!-- Page Header -->
  <div class="page-header">
    <h1>
      <i class="fa fa-dashboard"></i> Super Admin
      <div class="pull-right">
        <button class="btn btn-primary" ng-click="showVerification = !showVerification">
          <i class="fa fa-user-check"></i> 
          Owner Verification
          <span class="badge" style="background-color: red; color: white;" ng-if="pendingOwners.length > 0">
            {{pendingOwners.length}}
          </span>
        </button>
      </div>
    </h1>
  </div>

  <!-- Loading Panel -->
  <div class="panel panel-default" ng-show="isLoading">
    <div class="panel-body text-center">
      <p><i class="fa fa-spinner fa-spin fa-3x"></i></p>
      <p class="text-muted">Loading analytics data...</p>
    </div>
  </div>

  <!-- Owner Verification Panel - separately toggleable -->
  <div class="panel panel-primary" ng-show="showVerification" style="margin-bottom: 20px;">
    <div class="panel-heading">
      <h3 class="panel-title">
        <i class="fa fa-user-check"></i> Owner Verification
        <span class="badge" style="background-color: white; color: #337ab7;" ng-if="pendingOwners.length > 0">
          {{pendingOwners.length}}
        </span>
        <button type="button" class="close" ng-click="showVerification = false">
          <span aria-hidden="true">&times;</span>
        </button>
      </h3>
    </div>
    <div class="panel-body">
      <div ng-show="pendingOwners.length === 0" class="text-center">
        <p class="text-muted">No pending owner verification requests.</p>
      </div>
      
      <div ng-show="pendingOwners.length > 0">
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="owner in pendingOwners">
                <td>{{owner.firstName}} {{owner.lastName}}</td>
                <td>{{owner.email}}</td>
                <td>{{owner.phone}}</td>
                <td>
                  <button class="btn btn-sm btn-success" ng-click="verifyOwner(owner)">
                    <i class="fa fa-check"></i> Accept
                  </button>
                  <button class="btn btn-sm btn-danger" ng-click="rejectOwner(owner.id)">
                    <i class="fa fa-times"></i> Reject
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Analytics content - only shown when not loading -->
  <div ng-hide="isLoading">
    <uib-accordion>
      <!-- User Analytics Section -->
      <div uib-accordion-group class="panel-primary" is-open="true">
        <uib-accordion-heading>
          <i class="fa fa-users"></i> User Analytics
        </uib-accordion-heading>
        
        <div class="row">
          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">Users per Role</h3>
              </div>
              <div class="panel-body text-center">
                <div style="position: relative; height: 300px;">
                  <canvas id="usersPerRoleChart"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">Bid Status Distribution</h3>
              </div>
              <div class="panel-body text-center">
                <div style="position: relative; height: 300px;">
                  <canvas id="bidStatusChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </uib-accordion>
    
    <!-- Car Distribution Section -->
    <uib-accordion>
      <div uib-accordion-group class="panel-primary" is-open="true">
        <uib-accordion-heading>
          <i class="fa fa-car"></i> Car Distribution Analytics
        </uib-accordion-heading>
        
        <div class="row">
          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">Cars per Category</h3>
              </div>
              <div class="panel-body text-center">
                <div style="position: relative; height: 300px;">
                  <canvas id="carsPerCategoryChart"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">Cars per City</h3>
              </div>
              <div class="panel-body text-center">
                <div style="position: relative; height: 300px;">
                  <canvas id="carsPerCityChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </uib-accordion>
    
    <uib-accordion>
      <!-- Technical Analytics Section -->
      <div uib-accordion-group class="panel-primary" is-open="true">
        <uib-accordion-heading>
          <i class="fa fa-cogs"></i> Technical Analytics
        </uib-accordion-heading>
        
        <div class="row">
          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">Cars per Fuel Type</h3>
              </div>
              <div class="panel-body text-center">
                <div style="position: relative; height: 300px;">
                  <canvas id="carsPerFuelTypeChart"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="panel panel-default">
              <div class="panel-heading">
                <h3 class="panel-title">Cars Type</h3>
              </div>
              <div class="panel-body text-center">
                <div style="position: relative; height: 300px;">
                  <canvas id="luxuryCarsChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Revenue Analytics Section -->
    </uib-accordion>
  </div>
</div>